import{D as b,l as i,u,m as t,o as l,K as m,y as n,R as D,P as f,A as S,E as w,z as F,f as v,i as T,e as I,k as L}from"./vendor-2qHTh_Dj.js";import{i as V,h as q}from"./InstallerApi-Dj1wJ3Su.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{ArrowRight as N,ArrowLeft as U,LucideWifi as M,Info as P,LucideX as R,Check as Q,Database as j}from"./ui-ChkuEbnX.js";import"./utils-11VKenW5.js";const B={name:"InstallerDatabase",components:{Database:j,Check:Q,X:R,Info:P,Wifi:M,ArrowLeft:U,ArrowRight:N},props:{form:{type:Object,required:!0}},emits:["next","back","update:form"],setup(a,{emit:e}){const d=v(""),s=v(""),r=T({connection:a.form.connection||"mysql",host:a.form.host||"localhost",port:a.form.port||3306,name:a.form.name||"",username:a.form.username||"",password:a.form.password||""}),g=I(()=>r.connection==="sqlite"?!0:r.host&&r.port&&r.name&&r.username),c=()=>{e("update:form",{...r})},k=async()=>{if(g.value){d.value="testing",s.value="";try{const x=await V("/install/test-database",{body:JSON.stringify(r)}),p=await q(x);p.success?(d.value="success",e("update:form",{...r,tested:!0})):(d.value="failed",s.value=p.message||"Connection failed")}catch(x){d.value="failed",s.value="Network error. Please try again.",console.error("Database test error:",x)}}};return L(r,()=>{c(),d.value&&(d.value="",s.value="")},{deep:!0}),{form:r,connectionStatus:d,connectionError:s,canTestConnection:g,updateForm:c,testConnection:k}}},E={class:"animate-fade-in-up"},W={class:"text-center mb-8"},X={class:"w-20 h-20 bg-gradient-to-br from-orange-500 to-red-600 rounded-2xl flex items-center justify-center mx-auto mb-6"},_={class:"max-w-2xl mx-auto"},z={class:"bg-slate-50 dark:bg-slate-700/50 rounded-xl p-6 mb-6"},H={class:"space-y-4"},O={key:0,class:"space-y-4"},Y={class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},J={class:"flex items-start"},K={key:1,class:"space-y-4"},G=["placeholder"],Z={class:"bg-slate-50 dark:bg-slate-700/50 rounded-xl p-6 mb-6"},$={class:"flex items-center justify-between mb-4"},ee=["disabled"],te={key:0,class:"flex items-center"},se={key:1,class:"flex items-center"},oe={key:0,class:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4"},re={class:"flex items-center"},ae={key:1,class:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-4"},le={class:"flex items-center"},ne={class:"text-sm text-red-700 dark:text-red-300 mt-1"},de={key:2,class:"text-center py-8"},ie={class:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-xl p-6"},ue={class:"flex items-start"},be={class:"flex justify-between items-center mt-8 pt-6 border-t border-slate-200 dark:border-slate-700"},me=["disabled"];function ce(a,e,d,s,r,g){const c=b("Database",!0),k=b("Info"),x=b("Wifi"),p=b("Check"),y=b("X"),h=b("ArrowLeft"),C=b("ArrowRight");return u(),i("div",E,[t("div",W,[t("div",X,[l(c,{class:"w-10 h-10 text-white"})]),e[15]||(e[15]=t("h2",{class:"text-3xl font-bold text-slate-900 dark:text-white mb-4"}," Database Configuration ",-1)),e[16]||(e[16]=t("p",{class:"text-lg text-slate-600 dark:text-slate-400 max-w-2xl mx-auto"}," Configure your database connection settings. Make sure your database is created and accessible. ",-1))]),t("div",_,[t("div",z,[t("div",H,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"},[n(" Database Type "),t("span",{class:"text-red-500"},"*")],-1)),m(t("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>s.form.connection=o),class:"w-full px-4 py-3 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 transition-all duration-200",onChange:e[1]||(e[1]=(...o)=>s.updateForm&&s.updateForm(...o))},[...e[17]||(e[17]=[t("option",{value:"mysql"},"MySQL",-1),t("option",{value:"pgsql"},"PostgreSQL",-1),t("option",{value:"sqlite"},"SQLite",-1)])],544),[[D,s.form.connection]])]),s.form.connection==="sqlite"?(u(),i("div",O,[t("div",Y,[t("div",J,[l(k,{class:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-3 mt-0.5"}),e[19]||(e[19]=t("div",null,[t("h4",{class:"text-sm font-medium text-blue-800 dark:text-blue-200"},"SQLite Database"),t("p",{class:"text-sm text-blue-700 dark:text-blue-300 mt-1"}," SQLite will create a database file automatically. No additional configuration needed. ")],-1))])])])):(u(),i("div",K,[t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"},[n(" Database Host "),t("span",{class:"text-red-500"},"*")],-1)),m(t("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>s.form.host=o),type:"text",placeholder:"localhost",class:"w-full px-4 py-3 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white placeholder-slate-500 dark:placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 transition-all duration-200",onInput:e[3]||(e[3]=(...o)=>s.updateForm&&s.updateForm(...o))},null,544),[[f,s.form.host]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"},[n(" Database Port "),t("span",{class:"text-red-500"},"*")],-1)),m(t("input",{"onUpdate:modelValue":e[4]||(e[4]=o=>s.form.port=o),type:"number",placeholder:s.form.connection==="mysql"?"3306":"5432",class:"w-full px-4 py-3 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white placeholder-slate-500 dark:placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 transition-all duration-200",onInput:e[5]||(e[5]=(...o)=>s.updateForm&&s.updateForm(...o))},null,40,G),[[f,s.form.port]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"},[n(" Database Name "),t("span",{class:"text-red-500"},"*")],-1)),m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=o=>s.form.name=o),type:"text",placeholder:"helpdesk_db",class:"w-full px-4 py-3 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white placeholder-slate-500 dark:placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 transition-all duration-200",onInput:e[7]||(e[7]=(...o)=>s.updateForm&&s.updateForm(...o))},null,544),[[f,s.form.name]]),e[23]||(e[23]=t("p",{class:"mt-1 text-sm text-slate-500 dark:text-slate-400"}," Make sure this database exists on your server ",-1))]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"},[n(" Database Username "),t("span",{class:"text-red-500"},"*")],-1)),m(t("input",{"onUpdate:modelValue":e[8]||(e[8]=o=>s.form.username=o),type:"text",placeholder:"root",class:"w-full px-4 py-3 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white placeholder-slate-500 dark:placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 transition-all duration-200",onInput:e[9]||(e[9]=(...o)=>s.updateForm&&s.updateForm(...o))},null,544),[[f,s.form.username]])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2"}," Database Password ",-1)),m(t("input",{"onUpdate:modelValue":e[10]||(e[10]=o=>s.form.password=o),type:"password",placeholder:"Your database password",class:"w-full px-4 py-3 bg-white dark:bg-slate-800 border border-slate-300 dark:border-slate-600 rounded-lg text-slate-900 dark:text-white placeholder-slate-500 dark:placeholder-slate-400 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 dark:focus:ring-blue-400 dark:focus:border-blue-400 transition-all duration-200",onInput:e[11]||(e[11]=(...o)=>s.updateForm&&s.updateForm(...o))},null,544),[[f,s.form.password]])])]))])]),t("div",Z,[t("div",$,[e[28]||(e[28]=t("h3",{class:"text-lg font-semibold text-slate-900 dark:text-white"},"Test Connection",-1)),t("button",{onClick:e[12]||(e[12]=(...o)=>s.testConnection&&s.testConnection(...o)),disabled:!s.canTestConnection||s.connectionStatus==="testing",class:w(["px-4 py-2 rounded-lg font-medium transition-all duration-200",s.canTestConnection&&s.connectionStatus!=="testing"?"bg-blue-600 hover:bg-blue-700 text-white":"bg-slate-300 dark:bg-slate-600 text-slate-500 dark:text-slate-400 cursor-not-allowed"])},[s.connectionStatus==="testing"?(u(),i("div",te,[...e[26]||(e[26]=[t("div",{class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"},null,-1),n(" Testing... ",-1)])])):(u(),i("div",se,[l(x,{class:"w-4 h-4 mr-2"}),e[27]||(e[27]=n(" Test Connection ",-1))]))],10,ee)]),s.connectionStatus==="success"?(u(),i("div",oe,[t("div",re,[l(p,{class:"w-5 h-5 text-green-600 dark:text-green-400 mr-3"}),e[29]||(e[29]=t("div",null,[t("h4",{class:"text-sm font-medium text-green-800 dark:text-green-200"},"Connection Successful"),t("p",{class:"text-sm text-green-700 dark:text-green-300 mt-1"}," Database connection is working properly. You can proceed with the installation. ")],-1))])])):s.connectionStatus==="failed"?(u(),i("div",ae,[t("div",le,[l(y,{class:"w-5 h-5 text-red-600 dark:text-red-400 mr-3"}),t("div",null,[e[30]||(e[30]=t("h4",{class:"text-sm font-medium text-red-800 dark:text-red-200"},"Connection Failed",-1)),t("p",ne,F(s.connectionError||"Please check your database settings and try again."),1)])])])):s.connectionStatus===""?(u(),i("div",de,[l(c,{class:"w-12 h-12 text-slate-400 mx-auto mb-3"}),e[31]||(e[31]=t("p",{class:"text-slate-500 dark:text-slate-400"},' Click "Test Connection" to verify your database settings ',-1))])):S("",!0)]),t("div",ie,[t("div",ue,[l(k,{class:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-3 mt-0.5"}),e[32]||(e[32]=t("div",null,[t("h4",{class:"text-sm font-medium text-blue-800 dark:text-blue-200 mb-2"},"Database Setup Tips"),t("ul",{class:"text-sm text-blue-700 dark:text-blue-300 space-y-1"},[t("li",null,"• Create a new database for your HelpDesk installation"),t("li",null,"• Use a dedicated database user with appropriate permissions"),t("li",null,"• Make sure your database server is running and accessible"),t("li",null,"• For shared hosting, use the credentials provided by your host")])],-1))])])]),t("div",be,[t("button",{onClick:e[13]||(e[13]=o=>a.$emit("back")),class:"px-6 py-3 text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white transition-colors"},[l(h,{class:"w-4 h-4 mr-2 inline"}),e[33]||(e[33]=n(" Back ",-1))]),t("button",{onClick:e[14]||(e[14]=o=>a.$emit("next")),disabled:s.connectionStatus!=="success",class:w(["px-8 py-3 rounded-lg font-semibold transition-all duration-200 transform",s.connectionStatus==="success"?"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700 text-white hover:scale-105 shadow-lg hover:shadow-xl":"bg-slate-300 dark:bg-slate-600 text-slate-500 dark:text-slate-400 cursor-not-allowed"])},[e[34]||(e[34]=n(" Continue ",-1)),l(C,{class:"w-4 h-4 ml-2 inline"})],10,me)])])}const we=A(B,[["render",ce]]);export{we as default};
