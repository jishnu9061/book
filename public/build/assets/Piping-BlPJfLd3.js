import{X as S,D as a,l as p,u as m,o as n,m as e,z as s,M as b,y as d,A as h,J as R,K as T,L as E,E as g,G as f}from"./vendor-LkufkiF7.js";import{L}from"./Layout-DdwsTprQ.js";import{T as N}from"./TextInput-BYPeFz6K.js";import{S as V}from"./SelectInput-BezpKrUW.js";import{L as U}from"./LoadingButton-DNgtCulM.js";import{a as H}from"./utils-Cv2kkzzw.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{AlertTriangle as W,Clock as j,CircleHelp as Y,CircleX as B,CheckCircle as $,Loader2 as q,LucideWifi as X,LucideServer as F,LucideMail as z}from"./ui-DZ0wy3Ge.js";import"./LogoutButton-CfMbGx4V.js";import"./app-BMhdMQxL.js";import"./Logo-CwTRbPbO.js";import"./FlashMessages-Bge5XBye.js";const G={components:{Head:S,TextInput:N,SelectInput:V,LoadingButton:U,Mail:z,Server:F,Wifi:X,Loader2:q,CheckCircle:$,XCircle:B,HelpCircle:Y,Clock:j,AlertTriangle:W},layout:L,props:{title:String,demo:Boolean,keys:Object,option:Object},remember:"form",data(){return{testingConnection:!1,testResult:null,basePath:window.location.origin,baseUrl:window.location.origin,form:this.$inertia.form({IMAP_HOST:this.keys.IMAP_HOST||"",IMAP_PORT:this.keys.IMAP_PORT||"",IMAP_PROTOCOL:this.keys.IMAP_PROTOCOL||"",IMAP_ENCRYPTION:this.keys.IMAP_ENCRYPTION||"",IMAP_USERNAME:this.keys.IMAP_USERNAME||"",IMAP_PASSWORD:this.keys.IMAP_PASSWORD||""})}},methods:{update(){this.form.post(route("settings.piping.update"))},updatePipingOption(){this.$inertia.put(route("settings.piping.option.update"),{value:this.option.value})},async testConnection(){var t,l;this.testingConnection=!0,this.testResult=null;try{const i=await H.post(route("settings.piping.test"),{IMAP_HOST:this.form.IMAP_HOST,IMAP_PORT:this.form.IMAP_PORT,IMAP_PROTOCOL:this.form.IMAP_PROTOCOL,IMAP_ENCRYPTION:this.form.IMAP_ENCRYPTION,IMAP_USERNAME:this.form.IMAP_USERNAME,IMAP_PASSWORD:this.form.IMAP_PASSWORD});this.testResult={success:i.data.success,message:i.data.message}}catch(i){this.testResult={success:!1,message:((l=(t=i.response)==null?void 0:t.data)==null?void 0:l.message)||this.$t("Connection test failed. Please check your settings.")}}finally{this.testingConnection=!1}}}},J={class:"min-h-screen bg-slate-50 dark:bg-slate-900"},K={class:"bg-white dark:bg-slate-800 shadow-sm border-b border-slate-200 dark:border-slate-700"},Q={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},Z={class:"py-6"},ee={class:"flex items-center justify-between"},te={class:"text-2xl font-bold text-slate-900 dark:text-white"},se={class:"mt-1 text-sm text-slate-500 dark:text-slate-400"},oe={class:"flex items-center gap-3"},le=["disabled"],re={class:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"},ne={class:"bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 overflow-hidden"},ie={class:"p-8"},ae={class:"mb-8"},de={class:"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800"},me={class:"flex-1"},ce={class:"text-lg font-medium text-blue-900 dark:text-blue-100 mb-2 flex items-center gap-2"},ue={class:"text-sm text-blue-800 dark:text-blue-200"},pe={class:"flex items-center cursor-pointer"},ge={class:"relative"},be={key:0,class:"mb-8 p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg border border-yellow-200 dark:border-yellow-800"},he={class:"flex items-center gap-2"},_e={class:"text-sm text-yellow-800 dark:text-yellow-200"},fe={key:1,class:"mb-8"},Pe={class:"text-lg font-medium text-slate-900 dark:text-white mb-4 flex items-center gap-2"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ae={value:""},ve={value:"ssl"},Me={value:"tls"},Ie={key:2,class:"mb-8"},xe={class:"flex items-center gap-2"},Ce={class:"px-8 py-4 bg-slate-50 dark:bg-slate-700 border-t border-slate-200 dark:border-slate-600 flex items-center justify-between"},we={class:"text-sm text-slate-500 dark:text-slate-400"},ye={key:0,class:"mt-8 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 p-6"},Oe={class:"text-lg font-medium text-slate-900 dark:text-white mb-4 flex items-center gap-2"},Se={class:"space-y-4"},Re={class:"font-medium text-slate-900 dark:text-white mb-2"},Te={class:"text-sm text-slate-600 dark:text-slate-400 mb-2"},Ee={class:"bg-slate-900 dark:bg-slate-700 rounded-lg p-4 font-mono text-sm text-green-400 overflow-x-auto"},Le={class:"font-medium text-slate-900 dark:text-white mb-2"},Ne={class:"text-sm text-slate-600 dark:text-slate-400 mb-2"},Ve={class:"bg-slate-900 dark:bg-slate-700 rounded-lg p-4 font-mono text-sm text-green-400 overflow-x-auto"},Ue={class:"mt-8 bg-blue-50 dark:bg-blue-900/20 rounded-lg border border-blue-200 dark:border-blue-800 p-6"},He={class:"text-lg font-medium text-blue-900 dark:text-blue-100 mb-3 flex items-center gap-2"},De={class:"text-sm text-blue-800 dark:text-blue-200 space-y-2"},We={class:"mt-8 bg-green-50 dark:bg-green-900/20 rounded-lg border border-green-200 dark:border-green-800 p-6"},je={class:"text-lg font-medium text-green-900 dark:text-green-100 mb-3 flex items-center gap-2"},Ye={class:"text-sm text-green-800 dark:text-green-200 space-y-2"};function Be(t,l,i,$e,o,c){const P=a("Head"),k=a("Loader2"),A=a("Wifi"),_=a("Mail"),v=a("AlertTriangle"),M=a("Server"),u=a("TextInput"),I=a("SelectInput"),x=a("CheckCircle"),C=a("XCircle"),w=a("LoadingButton"),y=a("Clock"),O=a("HelpCircle");return m(),p("div",J,[n(P,{title:i.title},null,8,["title"]),e("div",K,[e("div",Q,[e("div",Z,[e("div",ee,[e("div",null,[e("h1",te,s(t.$t("Email Piping Settings")),1),e("p",se,s(t.$t("Configure email piping to automatically create tickets from incoming emails")),1)]),e("div",oe,[e("button",{onClick:l[0]||(l[0]=(...r)=>c.testConnection&&c.testConnection(...r)),disabled:o.testingConnection,class:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors duration-200 shadow-sm hover:shadow-md"},[o.testingConnection?(m(),b(k,{key:0,class:"w-4 h-4 animate-spin"})):(m(),b(A,{key:1,class:"w-4 h-4"})),d(" "+s(o.testingConnection?t.$t("Testing..."):t.$t("Test Connection")),1)],8,le)])])])])]),e("div",re,[e("div",ne,[e("form",{onSubmit:l[9]||(l[9]=R((...r)=>c.update&&c.update(...r),["prevent"]))},[e("div",ie,[e("div",ae,[e("div",de,[e("div",me,[e("h3",ce,[n(_,{class:"w-5 h-5"}),d(" "+s(t.$t("Enable Email Piping")),1)]),e("p",ue,s(t.$t("Automatically create tickets from incoming emails including attachments")),1)]),e("label",pe,[e("div",ge,[T(e("input",{type:"checkbox",class:"sr-only","onUpdate:modelValue":l[1]||(l[1]=r=>i.option.value=r),onChange:l[2]||(l[2]=(...r)=>c.updatePipingOption&&c.updatePipingOption(...r))},null,544),[[E,i.option.value]]),e("div",{class:g(["w-12 h-6 rounded-full shadow-inner transition-colors duration-200",i.option.value?"bg-blue-600":"bg-gray-400"])},null,2),e("div",{class:g(["absolute w-5 h-5 bg-white rounded-full shadow transform transition-transform duration-200 top-0.5",i.option.value?"translate-x-6":"translate-x-0.5"])},null,2)])])])]),i.demo?(m(),p("div",be,[e("div",he,[n(v,{class:"w-5 h-5 text-yellow-600"}),e("p",_e,s(t.$t("Demo Mode: You can test email piping by sending emails to piping@atorali.com")),1)])])):h("",!0),i.option.value?(m(),p("div",fe,[e("h3",Pe,[n(M,{class:"w-5 h-5 text-green-600"}),d(" "+s(t.$t("IMAP Configuration")),1)]),e("div",ke,[n(u,{modelValue:o.form.IMAP_HOST,"onUpdate:modelValue":l[3]||(l[3]=r=>o.form.IMAP_HOST=r),error:o.form.errors.IMAP_HOST,label:t.$t("IMAP Host"),placeholder:t.$t("imap.gmail.com"),required:""},null,8,["modelValue","error","label","placeholder"]),n(u,{modelValue:o.form.IMAP_PORT,"onUpdate:modelValue":l[4]||(l[4]=r=>o.form.IMAP_PORT=r),error:o.form.errors.IMAP_PORT,label:t.$t("IMAP Port"),placeholder:t.$t("993"),type:"number",required:""},null,8,["modelValue","error","label","placeholder"]),n(u,{modelValue:o.form.IMAP_PROTOCOL,"onUpdate:modelValue":l[5]||(l[5]=r=>o.form.IMAP_PROTOCOL=r),error:o.form.errors.IMAP_PROTOCOL,label:t.$t("IMAP Protocol"),placeholder:t.$t("imap"),required:""},null,8,["modelValue","error","label","placeholder"]),n(I,{modelValue:o.form.IMAP_ENCRYPTION,"onUpdate:modelValue":l[6]||(l[6]=r=>o.form.IMAP_ENCRYPTION=r),error:o.form.errors.IMAP_ENCRYPTION,label:t.$t("IMAP Encryption")},{default:f(()=>[e("option",Ae,s(t.$t("None")),1),e("option",ve,s(t.$t("SSL")),1),e("option",Me,s(t.$t("TLS")),1)]),_:1},8,["modelValue","error","label"]),n(u,{modelValue:o.form.IMAP_USERNAME,"onUpdate:modelValue":l[7]||(l[7]=r=>o.form.IMAP_USERNAME=r),error:o.form.errors.IMAP_USERNAME,label:t.$t("IMAP Username"),placeholder:t.$t("your-email@gmail.com"),required:""},null,8,["modelValue","error","label","placeholder"]),n(u,{modelValue:o.form.IMAP_PASSWORD,"onUpdate:modelValue":l[8]||(l[8]=r=>o.form.IMAP_PASSWORD=r),error:o.form.errors.IMAP_PASSWORD,label:t.$t("IMAP Password"),type:"password",placeholder:t.$t("Your email password or app password"),required:""},null,8,["modelValue","error","label","placeholder"])])])):h("",!0),o.testResult?(m(),p("div",Ie,[e("div",{class:g(["p-4 rounded-lg border",o.testResult.success?"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800":"bg-red-50 border-red-200 dark:bg-red-900/20 dark:border-red-800"])},[e("div",xe,[o.testResult.success?(m(),b(x,{key:0,class:"w-5 h-5 text-green-600"})):(m(),b(C,{key:1,class:"w-5 h-5 text-red-600"})),e("h4",{class:g(["font-medium",o.testResult.success?"text-green-800 dark:text-green-200":"text-red-800 dark:text-red-200"])},s(o.testResult.success?t.$t("Connection Successful"):t.$t("Connection Failed")),3)]),e("p",{class:g(["mt-2 text-sm",o.testResult.success?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300"])},s(o.testResult.message),3)],2)])):h("",!0)]),e("div",Ce,[e("div",we,s(t.$t("Email piping will be enabled after saving and setting up cron job")),1),n(w,{loading:o.form.processing,class:"btn-indigo",type:"submit"},{default:f(()=>[d(s(t.$t("Save Settings")),1)]),_:1},8,["loading"])])],32)]),i.option.value?(m(),p("div",ye,[e("h3",Oe,[n(y,{class:"w-5 h-5 text-purple-600"}),d(" "+s(t.$t("Cron Job Setup Instructions")),1)]),e("div",Se,[e("div",null,[e("h4",Re,s(t.$t("For VPS/Dedicated Servers:")),1),e("p",Te,s(t.$t("Add this cron job to run every 3 minutes:")),1),e("div",Ee,[e("code",null,"*/3 * * * * /usr/bin/php "+s(o.basePath)+"/artisan command:piping_email",1)])]),e("div",null,[e("h4",Le,s(t.$t("For Shared Hosting (cPanel):")),1),e("p",Ne,s(t.$t("Add this URL-based cron job to run every 3 minutes:")),1),e("div",Ve,[e("code",null,"*/3 * * * * wget -q -O - "+s(o.baseUrl)+"/cron/piping >/dev/null 2>&1",1)])])])])):h("",!0),e("div",Ue,[e("h3",He,[n(O,{class:"w-5 h-5"}),d(" "+s(t.$t("Email Piping Help")),1)]),e("div",De,[e("p",null,[e("strong",null,s(t.$t("Gmail:")),1),d(" "+s(t.$t("Use imap.gmail.com, port 993, SSL encryption, and enable 2-factor authentication with an app password.")),1)]),e("p",null,[e("strong",null,s(t.$t("Outlook:")),1),d(" "+s(t.$t("Use outlook.office365.com, port 993, SSL encryption.")),1)]),e("p",null,[e("strong",null,s(t.$t("Yahoo:")),1),d(" "+s(t.$t("Use imap.mail.yahoo.com, port 993, SSL encryption, and use an app password.")),1)]),e("p",null,[e("strong",null,s(t.$t("Custom IMAP:")),1),d(" "+s(t.$t("Contact your email provider for the correct IMAP settings.")),1)])])]),e("div",We,[e("h3",je,[n(_,{class:"w-5 h-5"}),d(" "+s(t.$t("Email Piping Features")),1)]),e("div",Ye,[e("p",null,"• "+s(t.$t("Automatic ticket creation from emails")),1),e("p",null,"• "+s(t.$t("Email attachments are included as ticket attachments")),1),e("p",null,"• "+s(t.$t("Email sender becomes the ticket customer")),1),e("p",null,"• "+s(t.$t("Email subject becomes the ticket subject")),1),e("p",null,"• "+s(t.$t("Email body becomes the ticket description")),1)])])])])}const ot=D(G,[["render",Be]]);export{ot as default};
